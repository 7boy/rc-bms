(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-485920c8"],{"1e9d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"index"},[r("bread-nav",{attrs:{nav:e.nav}}),r("main-part",[r("div",{staticClass:"btn-block"},[r("span",{staticClass:"btn-main",on:{click:e.doImport}},[e._v("导入检查结果")]),r("span",{staticClass:"btn-main ml15",on:{click:function(t){e.$exportDetail("/export/exportAssessRegularRecord.do",e.query)}}},[e._v("导出")])]),r("div",{staticClass:"search-box"},[r("div",{staticClass:"item"},[r("span",{staticClass:"text"},[e._v("年级")]),r("el-select",{on:{change:e.onGradeChange},model:{value:e.query.gradeId,callback:function(t){e.$set(e.query,"gradeId",t)},expression:"query.gradeId"}},e._l(e.gradeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),r("div",{staticClass:"item"},[r("span",{staticClass:"text"},[e._v("月份")]),r("el-date-picker",{staticClass:"input",attrs:{"value-format":"yyyy-MM-dd 00:00:00",type:"month",clearable:""},on:{change:e.onMonthChange},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1),r("div",{staticClass:"item"},[r("span",{staticClass:"text"},[e._v("周")]),r("el-select",{on:{change:e.getDetail},model:{value:e.query.weekId,callback:function(t){e.$set(e.query,"weekId",t)},expression:"query.weekId"}},e._l(e.weekList,function(e,t){return r("el-option",{key:t,attrs:{label:e.weekDesc,value:e.id}})}))],1)]),r("div",{staticClass:"table-box"},[r("div",{domProps:{innerHTML:e._s(e.tableHTML)}})])]),r("el-dialog",{staticClass:"dialog",attrs:{visible:e.dialogVisible,width:"500px",lazy:"",title:"导入检查结果"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",staticClass:"form",attrs:{"label-width":"90px",model:e.submit,rules:e.rules}},[r("el-form-item",{attrs:{label:"检查类型",prop:"assessRegularRecordType"}},[r("el-select",{model:{value:e.submit.assessRegularRecordType,callback:function(t){e.$set(e.submit,"assessRegularRecordType",t)},expression:"submit.assessRegularRecordType"}},e._l(e.$enums.AssessRegularRecordType.list,function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),r("el-form-item",{attrs:{label:"年级",prop:"gradeId"}},[r("el-select",{model:{value:e.submit.gradeId,callback:function(t){e.$set(e.submit,"gradeId",t)},expression:"submit.gradeId"}},e._l(e.gradeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),r("el-form-item",{attrs:{label:"周",prop:"weekId"}},[r("el-select",{model:{value:e.submit.weekId,callback:function(t){e.$set(e.submit,"weekId",t)},expression:"submit.weekId"}},e._l(e.curTermWeekList,function(e,t){return r("el-option",{key:t,attrs:{label:e.weekDesc,value:e.id}})}))],1)],1),r("import-excel",{attrs:{type:"常规检查总表导入模板"},on:{"btn-click":e.onUploadBtnClick,change:e.onFileChange}})],1)],1)},s=[],n=(r("6d67"),r("96cf"),r("1da1")),i=r("c8e7"),l={mixins:[i["a"].$exportDetail,i["a"].$spliceHTML],data:function(){return{nav:[{name:"常规检查",path:""}],gradeList:[],weekList:[],curTermWeekList:[],month:(new Date).$Format("yyyy-MM-dd 00:00:00"),query:{gradeId:null,weekId:null},tableHTML:"",dialogVisible:!1,rules:{assessRegularRecordType:{required:!0,message:"请选择检查类型",trigger:"change"},gradeId:{required:!0,message:"请选择年级",trigger:"change"},weekId:{required:!0,message:"请选择周",trigger:"change"}},submit:{assessRegularRecordType:null,gradeId:null,weekId:null}}},methods:{getGradeList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/grade/queryGradeList.do"});case 2:this.gradeList=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getWeekList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/school/queryMonthWeekList.do",query:{queryDate:this.month}});case 2:this.weekList=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getCurTermWeekList:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/school/querySchoolTermWeekListWithCurrentTerm.do"});case 2:t=e.sent,this.curTermWeekList=t.map(function(e){return{id:e.id,weekDesc:e.weekDesc,startDate:e.startDate,endDate:e.endDate}});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getDetail:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.query.weekId){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.$ajax({url:"/assess/queryAssessRegularRecordList.do",el:".table-box",query:this.query});case 4:t=e.sent,this.tableHTML=this.$spliceHTML(t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),onGradeChange:function(){this.query.weekId=null},onMonthChange:function(){this.query.weekId=null,this.getWeekList()},doImport:function(){this.submit.gradeId=this.query.gradeId,this.dialogVisible=!0},onUploadBtnClick:function(e){this.$refs.form.validate(function(t){t||e.preventDefault()})},onFileChange:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,a,s,n,i,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.target.files,0!==r.length){e.next=3;break}return e.abrupt("return");case 3:return a=r[0],s=new FormData,s.append("file",a),n=this.submit,s.append("assessRegularRecordType",n.assessRegularRecordType),s.append("gradeId",n.gradeId),s.append("weekId",n.weekId),i={url:"/import/importAssessRegularRecord.do",query:s,el:".upload"},e.prev=11,e.next=14,this.$ajax(i);case 14:this.$message.success("上传成功"),this.dialogVisible=!1,this.query.gradeId=this.submit.gradeId,this.query.weekId=this.submit.weekId,this.getDetail(),e.next=23;break;case 21:e.prev=21,e.t0=e["catch"](11);case 23:l=document.getElementById("file-input"),l.value=null;case 25:case"end":return e.stop()}},e,this,[[11,21]])}));return function(t){return e.apply(this,arguments)}}()},mounted:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getGradeList();case 2:return this.query.gradeId=this.gradeList[0].id,e.next=5,this.getWeekList();case 5:this.query.weekId=this.weekList[0].id,this.getDetail(),this.getCurTermWeekList();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},u=l,o=(r("65b5"),r("2877")),c=Object(o["a"])(u,a,s,!1,null,"c121a1be",null);c.options.__file="Index.vue";t["default"]=c.exports},"65b5":function(e,t,r){"use strict";var a=r("ea26"),s=r.n(a);s.a},c8e7:function(e,t,r){"use strict";r("a481");t["a"]={$exportDetail:{methods:{$exportDetail:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.table.query,r="?";for(var a in t)t[a]&&"pageNo"!==a&&"pageSize"!==a&&(r+="".concat(a,"=").concat(t[a],"&"));window.open(this.$conf.API_PATH+e+r.substr(0,r.length-1))}}},$spliceHTML:{methods:{$spliceHTML:function(e){return e=e.replace('<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8">',""),e=e.replace("</head>",""),e=e.replace("</body></html>",""),e=e.replace(/<h2>(.*)<\/h2>/,""),e}}}}},ea26:function(e,t,r){}}]);
//# sourceMappingURL=chunk-485920c8.d9925f89.js.map