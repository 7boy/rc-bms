(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cadb3ec"],{"243d":function(e,t,n){"use strict";var i=n("9a3c"),a=n.n(i);a.a},"391e":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"publicity"},[n("bread-nav",{attrs:{nav:e.nav}}),n("main-part",[n("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"120px",rules:e.rules}},[n("el-form-item",{attrs:{label:"标题：",prop:"title"}},[n("el-input",{staticStyle:{width:"51%"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),n("el-form-item",{attrs:{label:"正文内容：",prop:"content"}},[e.form.content||!e.id?n("wang-editor",{attrs:{content:e.form.content},on:{"update:content":function(t){e.$set(e.form,"content",t)}}}):e._e()],1),n("el-form-item",{attrs:{label:"附件："}},[n("div",{staticClass:"upload_view"},[n("div",{staticClass:"upload_view_list"}),n("div",{staticClass:"upload_view_button"},[n("uploader",{ref:"uploadZone",staticClass:"upload_view_btn",attrs:{options:e.uploadOptions,"file-status-text":e.fileStatusText}},[n("uploader-unsupport"),n("uploader-btn",{attrs:{attrs:e.attrs}},[e._v("上传文件")]),e._l(e.form.attachmentList,function(t,i){return n("div",{staticClass:"item"},[n("span",[e._v("文件"+e._s(i+1)+"："),n("a",{attrs:{href:t.fileUrl}},[e._v(e._s(t.fileName))])]),n("i",{staticClass:"el-icon-close",on:{click:function(t){e.removeEnd(i)}}})])}),n("uploader-list")],2)],1)])]),n("el-form-item",{attrs:{label:"推送范围：",prop:"scopeList"}},[n("el-input",{staticClass:"input",staticStyle:{width:"440px"},attrs:{placeholder:"请选择范围",disabled:""},model:{value:e.selectedDepName.join(),callback:function(t){e.$set(e.selectedDepName,"join()",t)},expression:"selectedDepName.join()"}},[n("el-button",{staticClass:"hende",attrs:{slot:"append"},on:{click:e.showDepDialog},slot:"append"},[e._v("选择范围")])],1)],1)],1),n("el-dialog",{staticClass:"dep-dialog",attrs:{visible:e.depDialog,width:"400px"},on:{"update:visible":function(t){e.depDialog=t}}},[n("div",{staticClass:"dep-form"},[n("p",{staticClass:"title"},[e._v(e._s(e.depTitle))]),n("div",{staticClass:"content"},[n("item",{attrs:{data:e.depData,selectedDep:e.selectedDep,selectedDepName:e.selectedDepName},on:{"update:selectedDep":function(t){e.selectedDep=t},"update:selectedDepName":function(t){e.selectedDepName=t}}})],1),n("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[n("div",{staticClass:"btn-submit",on:{click:function(t){e.depDialog=!1}}},[e._v("关闭")])])])]),n("div",{staticClass:"btns"},[n("div",{staticClass:"btn-submit",on:{click:function(t){e.doSubmit()}}},[e._v("确定")]),n("div",{staticClass:"btn-clear",staticStyle:{"margin-left":"30px"},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")])])],1)],1)},a=[],s=(n("ac6a"),n("f3e2"),n("759f"),n("7f7f"),n("96cf"),n("1da1")),r=(n("a481"),n("5967")),c={components:{item:r["a"]},data:function(){var e=this,t=function(e,t,n){t&&"<p><br></p>"!==t?n():n(new Error("请输入正文内容"))},n=function(t,n,i){0===e.selectedDepName.length?i(new Error("请选择推送范围")):i()},i=this;return{id:i.$route.query.id,tabPick:i.$route.query.tabPick,announcementDetail:[],nav:[{name:"课题研究",path:"go(-1)"},{name:"发布课题研究",path:""}],text:"发布成功",depDialog:!1,depTitle:"",depData:[],selectedDep:[],selectedDepName:[],form:{title:null,content:null,scopeList:[],noticeType:"SUBJECT_STUDY",attachmentList:[]},attachmentList:[],attrs:{accept:"*"},rules:{title:{required:!0,message:"请输入标题",trigger:"blur"},content:{required:!0,validator:t,trigger:"change"},scopeList:{required:!0,validator:n,trigger:"change"}},uploadOptions:{target:"".concat(window.location.origin).concat(this.$conf.API_PATH,"/uploadFileTrunk/trunkUpload.do"),testChunks:!1,chunkSize:2097152,singleFile:!1,parseTimeRemaining:function(e,t){return t.replace(/\syears?/,"年").replace(/\days?/,"天").replace(/\shours?/,"小时").replace(/\sminutes?/,"分钟").replace(/\sseconds?/,"秒")}},fileStatusText:{success:"上传成功",error:"上传错误",uploading:"正在上传",paused:"已暂停",waiting:"等待中"}}},mounted:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAllDep();case 2:this.$nextTick(function(){var e=t.$refs.uploadZone;if(e){var n=e.uploader;n.on("fileSuccess",function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(n,i,a){var s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$ajax({url:"/uploadFileTrunk/mergeChunks.do",query:{fileMd5:i.uniqueIdentifier,fileName:i.name}});case 2:s=e.sent,t.attachmentList.push({fileName:i.name,fileUrl:s}),console.log(t.attachmentList);case 5:case"end":return e.stop()}},e,this)}));return function(t,n,i){return e.apply(this,arguments)}}()),n.on("fileRemoved",function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.attachmentList.some(function(e,i){if(e.name===n.name)return t.attachmentList.splice(i,1),!0});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())}}),this.id&&this.getDetail();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),watch:{"form.content":function(){var e=this;this.id&&setTimeout(function(){e.$refs.form.validate()},1)},"form.title":function(){var e=this;this.id&&setTimeout(function(){e.$refs.form.validate()},1)}},methods:{removeEnd:function(e){this.form.attachmentList.splice(e,1),console.log(this.form.attachmentList)},getAllDep:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=function(e,t){return e.forEach(function(e){e.tier=t,e.status=!1,e.subOrgList.length>0&&n(e.subOrgList,t+1)}),e},e.next=3,this.$ajax({url:"/org/queryOrganizationTree.do",query:{orgTypes:["ADMIN_ORG","TEACH_ORG"]}});case 3:t=e.sent,this.depTitle=t.orgName,this.depData=n(t.subOrgList,1);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getDetail:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/notice/getNotice.do",el:".form",query:{id:this.id}});case 2:this.announcementDetail=e.sent,console.log(this.announcementDetail),this.form.title=this.announcementDetail.title,this.form.content=this.announcementDetail.content,this.form.noticeType=this.announcementDetail.noticeType,this.announcementDetail.scopeList.forEach(function(e){t.selectedDep.push(e.businessId),t.selectedDepName.push(e.scopeName)}),this.form.attachmentList=this.announcementDetail.attachmentList;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showDepDialog:function(){this.depDialog=!0},doSubmit:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.form.validate();case 2:return this.attachmentList.length&&(this.form.attachmentList=this.form.attachmentList.concat(this.attachmentList)),this.form.scopeList=this.selectedDep,t="/notice/addNotice.do",this.id&&(this.text="修改成功",t="/notice/updateNotice.do",this.form.id=this.id,delete this.form.noticeType),e.next=8,this.$ajax({url:t,el:".form",query:this.form});case 8:this.$remind(this.text),this.$router.push("/research-orsay/research");case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},o=c,l=(n("8c30"),n("2877")),u=Object(l["a"])(o,i,a,!1,null,"4aec4112",null);u.options.__file="Publicity.vue";t["default"]=u.exports},5967:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-item"},e._l(e.treeData,function(t){return n("div",[n("div",{class:["item",{hand:t.subOrgList.length||1===t.parentOrgId}],style:{paddingLeft:25*(t.tier-1)+10+"px"},on:{click:function(e){t.status=!t.status}}},[n("i",{class:[{rotate:t.status},"el-icon-caret-right"],style:{visibility:t.subOrgList.length?"visible":"hidden"}}),n("el-checkbox",{attrs:{value:e.judge(t.orgId)},on:{change:function(n){e.changeDep(t)}}},[n("span",[e._v(e._s(t.orgName))])])],1),n("el-collapse-transition",[n("item",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"item.status"}],attrs:{selectedDepName:e.selectedDepName,selectedDep:e.selectedDep,data:t.subOrgList}})],1)],1)}))},a=[],s=(n("57e7"),n("5488")),r=n.n(s),c={components:{elCollapseTransition:r.a},props:["data","selectedDep","selectedDepName"],name:"item",data:function(){return{}},computed:{treeData:function(){return this.data},treeSelectedDep:function(){return this.selectedDep},treeSelectedDepName:function(){return this.selectedDepName||[]}},methods:{changeDep:function(e){var t=this.treeSelectedDep.indexOf(e.orgId);-1===t?(this.treeSelectedDep.push(e.orgId),this.treeSelectedDepName.push(e.orgName)):(this.treeSelectedDep.splice(t,1),this.treeSelectedDepName.splice(t,1)),this.$emit("update:selectedDep",this.treeSelectedDep),this.$emit("update:selectedDepName",this.treeSelectedDepName)},judge:function(e){return-1!==this.treeSelectedDep.indexOf(e)}},mounted:function(){}},o=c,l=(n("243d"),n("2877")),u=Object(l["a"])(o,i,a,!1,null,"97780030",null);u.options.__file="Item.vue";t["a"]=u.exports},"759f":function(e,t,n){"use strict";var i=n("5ca1"),a=n("0a49")(3);i(i.P+i.F*!n("2f21")([].some,!0),"Array",{some:function(e){return a(this,e,arguments[1])}})},"878f":function(e,t,n){},"8c30":function(e,t,n){"use strict";var i=n("878f"),a=n.n(i);a.a},"9a3c":function(e,t,n){}}]);
//# sourceMappingURL=chunk-0cadb3ec.dd935777.js.map