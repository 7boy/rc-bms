(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2656a085"],{7828:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"archives"},[a("bread-nav",{attrs:{nav:e.nav}}),a("main-part",[a("div",{staticClass:"btn-block"},[a("a",{staticClass:"f-small main-c mr5",attrs:{download:"",href:"../gy-files/template/档案批量导入模板.xlsx"}},[e._v("下载模板")]),a("label",{attrs:{for:"importDom"}},[a("div",{staticClass:"btn-main btn-upload mr15"},[e._v("批量导入")])]),a("input",{ref:"upload",attrs:{accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"importDom",type:"file",hidden:""},on:{change:function(t){e.upload(t)}}}),a("div",{staticClass:"btn-main-deepen mr15",on:{click:function(t){e.showStorageDialog()}}},[e._v("档案入库")]),a("div",{staticClass:"btn-main-deepen mr15",on:{click:function(t){e.$router.push("/personnel/archives/type")}}},[e._v("类别管理")]),a("div",{staticClass:"btn-main-deepen",on:{click:e.showPlaceDialog}},[e._v("位置管理")])]),a("search-box",{attrs:{searchData:e.searchData,table:e.table}}),a("resize-table",[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"13%"}},[e._v("档案编号")]),a("th",{attrs:{width:"17%"}},[e._v("类别")]),a("th",{attrs:{width:"20%"}},[e._v("归档内容")]),a("th",{attrs:{width:"12%"}},[e._v("保存期限")]),a("th",{attrs:{width:"8%"}},[e._v("状态")]),a("th",{attrs:{width:"12%"}},[e._v("位置")]),a("th",{attrs:{width:"18%"}},[e._v("操作")])])]),a("tbody",e._l(e.table.list,function(t){return a("tr",[a("td",[e._v(e._s(t.dossierNo||"--"))]),a("td",[e._v(e._s(t.dossierType))]),a("td",[e._v(e._s(t.content))]),a("td",[e._v(e._s(e.$enums.StorageLife.getName(t.storageLife)))]),a("td",[e._v(e._s(e.$enums.DossierStatus.getName(t.dossierStatus)))]),a("td",[e._v(e._s(t.dossierLocation))]),a("td",[a("span",{directives:[{name:"show",rawName:"v-show",value:"STOCK"===t.dossierStatus,expression:"item.dossierStatus === 'STOCK'"}],staticClass:"oper",on:{click:function(a){e.showLendDialog("LOAN",t)}}},[e._v("借出")]),a("span",{directives:[{name:"show",rawName:"v-show",value:"LOAN"===t.dossierStatus,expression:"item.dossierStatus === 'LOAN'"}],staticClass:"oper",on:{click:function(a){e.showLendDialog("STOCK",t)}}},[e._v("归还")]),a("span",{staticClass:"oper",on:{click:function(a){e.showChangeDialog(t)}}},[e._v("变动记录")]),a("span",{staticClass:"oper",on:{click:function(a){e.showStorageDialog(t)}}},[e._v("详细内容")])])])}))])]),a("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.table.noData,expression:"!table.noData"}]}),a("paging",{attrs:{data:e.table},on:{"update:data":function(t){e.table=t}}}),a("el-dialog",{staticClass:"place-dialog",attrs:{width:"540px",title:"位置管理",visible:e.placeDialog},on:{"update:visible":function(t){e.placeDialog=t}}},[a("span",[e._v("关键字")]),a("el-input",{staticClass:"input ml10",attrs:{placeholder:"位置名称"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.$search(e.place)}},model:{value:e.place.query.keywords,callback:function(t){e.$set(e.place.query,"keywords",t)},expression:"place.query.keywords"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.$search(e.place)}},slot:"append"})],1),a("div",{staticClass:"btn-submit",on:{click:function(t){e.operPlace("add")}}},[e._v("添加位置")]),a("resize-table",[a("table",{staticClass:"table palce-table mt15"},[a("thead",[a("tr",[a("th",{attrs:{width:"65%"}},[e._v("位置")]),a("th",{attrs:{width:"35%"}},[e._v("操作")])])]),a("tbody",[e.showAddPlace?a("tr",[a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入位置"},model:{value:e.ItemPlace,callback:function(t){e.ItemPlace=t},expression:"ItemPlace"}})],1),a("td",[a("span",{staticClass:"oper",on:{click:e.addPlaceFun}},[e._v("完成")]),a("span",{staticClass:"oper",on:{click:function(t){e.showAddPlace=!1}}},[e._v("取消")])])]):e._e(),e._l(e.place.list,function(t,s){return a("tr",[a("td",[a("p",{directives:[{name:"show",rawName:"v-show",value:!0!==t.itemStatus,expression:"item.itemStatus !== true"}]},[e._v(e._s(t.name))]),a("el-input",{directives:[{name:"show",rawName:"v-show",value:!0===t.itemStatus,expression:"item.itemStatus === true"}],attrs:{size:"small",placeholder:"请输入位置"},model:{value:e.ItemPlace,callback:function(t){e.ItemPlace=t},expression:"ItemPlace"}})],1),a("td",[a("span",{directives:[{name:"show",rawName:"v-show",value:!0!==t.itemStatus,expression:"item.itemStatus !== true"}],staticClass:"oper",on:{click:function(a){e.operPlace("edit",t,s)}}},[e._v("编辑")]),a("span",{directives:[{name:"show",rawName:"v-show",value:!0===t.itemStatus&&e.showAddPlace,expression:"item.itemStatus === true && showAddPlace"}],staticClass:"oper",on:{click:e.addPlaceFun}},[e._v("完成")]),a("span",{directives:[{name:"show",rawName:"v-show",value:!0===t.itemStatus&&!e.showAddPlace,expression:"item.itemStatus === true && !showAddPlace"}],staticClass:"oper",on:{click:e.editPlaceFun}},[e._v("完成")]),a("span",{directives:[{name:"show",rawName:"v-show",value:!0===t.itemStatus,expression:"item.itemStatus === true"}],staticClass:"oper",on:{click:function(a){e.cancelPlaceFun(t,s)}}},[e._v("取消")])])])})],2)])]),a("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.place.noData,expression:"!place.noData"}]}),a("paging",{attrs:{data:e.place},on:{"update:data":function(t){e.place=t}}})],1),a("el-dialog",{staticClass:"storage-dialog",attrs:{width:"540px",title:e.storage.id?"档案详情":"档案入库",visible:e.storageDialog},on:{"update:visible":function(t){e.storageDialog=t}}},[a("div",{staticClass:"storage-content"},[a("div",{staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v("保存期限")]),a("el-radio-group",{model:{value:e.storage.storageLife,callback:function(t){e.$set(e.storage,"storageLife",t)},expression:"storage.storageLife"}},e._l(e.$enums.StorageLife.list,function(t,s){return a("el-radio",{key:s,attrs:{label:t.value,border:""}},[e._v(e._s(t.label)+"    ")])}))],1),a("div",{staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v("归档内容")]),a("el-input",{staticClass:"input",attrs:{placeholder:"请输入归档内容"},model:{value:e.storage.content,callback:function(t){e.$set(e.storage,"content",t)},expression:"storage.content"}})],1),a("div",{staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v("档案类别")]),a("el-select",{staticClass:"input",attrs:{placeholder:"请选择档案类别"},model:{value:e.storage.dossierTypeId,callback:function(t){e.$set(e.storage,"dossierTypeId",t)},expression:"storage.dossierTypeId"}},e._l(e.docList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),a("div",{staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v("位置")]),a("el-select",{staticClass:"input",attrs:{"default-first-option":"",filterable:"",placeholder:"请选择档案位置"},model:{value:e.storage.dossierLocationId,callback:function(t){e.$set(e.storage,"dossierLocationId",t)},expression:"storage.dossierLocationId"}},e._l(e.docLocationList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),a("div",{staticClass:"item"},[a("span",{staticClass:"title"},[e._v("详细内容")]),a("el-input",{staticClass:"input",attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.storage.remark,callback:function(t){e.$set(e.storage,"remark",t)},expression:"storage.remark"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.storage.id,expression:"!storage.id"}],staticClass:"btns"},[a("div",{staticClass:"btn-submit btn-add mr15",on:{click:e.addStorage}},[e._v("确定")]),a("div",{staticClass:"btn-clear",on:{click:function(t){e.storageDialog=!1}}},[e._v("取消")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.storage.id,expression:"storage.id"}],staticClass:"btns"},[a("div",{staticClass:"btn-submit btn-save mr15",on:{click:e.saveStorage}},[e._v("保存")]),a("div",{staticClass:"btn-clear",on:{click:function(t){e.storageDialog=!1}}},[e._v("取消")])])])]),a("el-dialog",{staticClass:"storage-dialog",attrs:{width:"540px",title:"档案"+e.title,visible:e.lendDialog},on:{"update:visible":function(t){e.lendDialog=t}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"归还"===e.title,expression:"title === '归还'"}],staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v("借出人")]),a("el-input",{staticClass:"input",attrs:{type:"text",disabled:"",value:e.lendReturnForm.userName}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"借出"===e.title,expression:"title === '借出'"}],staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v(e._s(e.title)+"人")]),a("el-select",{staticClass:"input",attrs:{filterable:"","default-first-option":"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请输入教职工关键词","remote-method":e.getStaff,loading:e.loading},model:{value:e.lendReturnForm.userId,callback:function(t){e.$set(e.lendReturnForm,"userId",t)},expression:"lendReturnForm.userId"}},e._l(e.staffList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.idCard)+"/"+e._s(t.phone))])])}))],1),a("div",{staticClass:"item"},[a("span",{staticClass:"title imp"},[e._v(e._s(e.title)+"时间")]),a("el-date-picker",{staticClass:"input",attrs:{type:"date",placeholder:"选择日期"},model:{value:e.lendReturnForm.date,callback:function(t){e.$set(e.lendReturnForm,"date",t)},expression:"lendReturnForm.date"}})],1),a("div",{staticClass:"btns"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"借出"===e.title,expression:"title === '借出'"}],staticClass:"btn-submit mr15",on:{click:e.lendFun}},[e._v("确认")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"归还"===e.title,expression:"title === '归还'"}],staticClass:"btn-submit mr15",on:{click:e.returnFun}},[e._v("确认")]),a("div",{staticClass:"btn-clear",on:{click:function(t){e.lendDialog=!1}}},[e._v("取消")])])]),a("el-dialog",{staticClass:"storage-dialog",attrs:{width:"540px",title:"档案变动记录",visible:e.changeDialog},on:{"update:visible":function(t){e.changeDialog=t}}},[a("resize-table",[a("table",{staticClass:"table borrowed-table"},[a("thead",[a("tr",[a("th",[e._v("变动类型")]),a("th",[e._v("借出人")]),a("th",[e._v("借出/归还时间")])])]),a("tbody",e._l(e.borrowed.list,function(t){return a("tr",[a("td",[e._v(e._s(e.$enums.DossierStatus.getName(t.dossierStatus)))]),a("td",[e._v(e._s(t.userName))]),a("td",[e._v(e._s(e._f("substrTime")(t.recordDate)))])])}))])]),a("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.borrowed.noData,expression:"!borrowed.noData"}]}),a("paging",{attrs:{data:e.borrowed},on:{"update:data":function(t){e.borrowed=t}}})],1)],1)],1)},i=[],r=(a("6d67"),a("ac6a"),a("f3e2"),a("7f7f"),a("96cf"),a("1da1")),n={data:function(){return{nav:[{name:"档案管理",path:""}],searchData:[{type:"select",title:"类别",model:"dossierTypeId",option:[]},{type:"select",title:"保存期限",model:"storageLife",option:this.$enums.StorageLife.list},{type:"select",title:"状态",model:"dossierStatus",option:this.$enums.DossierStatus.list},{type:"input",placeholder:"档案编号/归档内容"}],table:{url:"/dossier/queryDossierPage.do",el:".table",total:0,noData:!0,list:[],query:{dossierTypeId:null,storageLife:null,dossierStatus:null,keywords:null}},placeDialog:!1,showAddPlace:!1,place:{url:"/dossier/queryDossierLocationPage.do",el:".palce-table",total:0,noData:!0,list:[],query:{keywords:null}},borrowed:{url:"/dossier/queryDossierRecordPage.do",el:".borrowed-table",total:0,noData:!0,list:[],query:{id:null,keywords:null}},title:"",ItemPlace:"",ItemPlaceId:"",storageDialog:!1,docList:[],docLocationList:[],storage:{dossierTypeId:null,dossierLocationId:null,content:"",storageLife:"APPROPRIATE",remark:""},lendDialog:!1,lendReturnForm:{id:"",userId:"",userName:"",date:null},changeDialog:!1,staffList:[],loading:!1}},methods:{showChangeDialog:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.changeDialog=!0,this.borrowed.query.id=t.id,this.$search(this.borrowed);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),showPlaceDialog:function(){this.placeDialog=!0,this.$search(this.place)},upload:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var a,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.target.files.length){e.next=2;break}return e.abrupt("return");case 2:return a=t.target.files[0],this.$refs.upload.value=null,s=new FormData,s.append("file",a),i={url:"/import/importDossier.do",query:s,el:".btn-upload",noText:!0},e.next=9,this.$ajax(i);case 9:e.sent,this.$remind("导入成功"),this.$search(this.table);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),operPlace:function(e,t,a){var s=this;"add"===e?(this.ItemPlace="",this.ItemPlaceId="",this.showAddPlace=!0):(this.ItemPlace=t.name,this.ItemPlaceId=t.id,this.place.list.forEach(function(e,t){e.itemStatus&&(e.itemStatus=!1,s.place.list.splice(t,1,e))}),t.itemStatus=!0,this.place.list.splice(a,1,t))},getStaff:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""===t){e.next=9;break}return this.loading=!0,e.next=4,this.$ajax({url:"/user/queryStaffPage.do",query:{keywords:t,pageNo:1,pageSize:1e7}});case 4:a=e.sent,this.loading=!1,this.staffList=a.list,e.next=10;break;case 9:this.staffList=[];case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),cancelPlaceFun:function(e,t){e.itemStatus=!1,this.place.list.splice(t,1,e)},addPlaceFun:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/dossier/addDossierLocation.do",query:{name:this.ItemPlace}});case 2:this.$remind("添加成功"),this.showAddPlace=!1,this.$search(this.place);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),editPlaceFun:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/dossier/updateDossierLocation.do",query:{name:this.ItemPlace,id:this.ItemPlaceId}});case 2:this.$remind("编辑成功"),this.$search(this.place);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showStorageDialog:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.storageDialog=!0,!t){e.next=8;break}return e.next=4,this.$ajax({url:"/dossier/getDossier.do",el:".storage-content",query:{id:t.id}});case 4:a=e.sent,this.storage=a,e.next=9;break;case 8:this.storage={dossierTypeId:null,dossierLocationId:null,content:"",storageLife:"APPROPRIATE",remark:""};case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getDocType:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/dossier/queryDossierTypeList.do"});case 2:this.docList=e.sent,this.searchData[0].option=this.docList.map(function(e){return{label:e.name,value:e.id}});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getDocLocation:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/dossier/queryDossierLocationList.do"});case 2:this.docLocationList=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),addStorage:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.storage.content){e.next=3;break}return this.$message.warning("请输入归档内容"),e.abrupt("return");case 3:if(this.storage.dossierTypeId){e.next=6;break}return this.$message.warning("请选择档案类别"),e.abrupt("return");case 6:if(this.storage.dossierLocationId){e.next=9;break}return this.$message.warning("请选择档案位置"),e.abrupt("return");case 9:return e.next=11,this.$ajax({url:"/dossier/addDossier.do",el:".btn-add",noText:!0,query:this.storage});case 11:this.storageDialog=!1,this.$remind("档案入库成功"),this.$search(this.table);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),saveStorage:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.storage.content){e.next=3;break}return this.$message.warning("请输入归档内容"),e.abrupt("return");case 3:if(this.storage.dossierTypeId){e.next=6;break}return this.$message.warning("请选择档案类别"),e.abrupt("return");case 6:if(this.storage.dossierLocationId){e.next=9;break}return this.$message.warning("请选择档案位置"),e.abrupt("return");case 9:return e.next=11,this.$ajax({url:"/dossier/updateDossier.do",el:".btn-save",noTrue:!0,query:this.storage});case 11:this.storageDialog=!1,this.$remind("档案修改成功"),this.$search(this.table);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showLendDialog:function(e,t){"STOCK"===e?this.title="归还":(this.getStaff(),this.title="借出"),this.lendDialog=!0,this.lendReturnForm={id:t.id,userId:null,userName:t.lastLoanName,date:null}},lendFun:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.lendReturnForm.userId){e.next=3;break}return this.$message.warning("请选择借出人"),e.abrupt("return");case 3:if(this.lendReturnForm.date){e.next=6;break}return this.$message.warning("请选择借出时间"),e.abrupt("return");case 6:return e.next=8,this.$ajax({url:"/dossier/loanDossier.do",query:{id:this.lendReturnForm.id,userId:this.lendReturnForm.userId,recordDate:new Date(this.lendReturnForm.date).$Format("yyyy-MM-dd")+" 00:00:00"}});case 8:this.lendDialog=!1,this.$remind("借出成功"),this.$search(this.table);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),returnFun:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.lendReturnForm.date){e.next=3;break}return this.$message.warning("请选择归还时间"),e.abrupt("return");case 3:return e.next=5,this.$ajax({url:"/dossier/returnDossier.do",query:{id:this.lendReturnForm.id,userId:this.lendReturnForm.userId,recordDate:new Date(this.lendReturnForm.date).$Format("yyyy-MM-dd")+" 00:00:00"}});case 5:this.lendDialog=!1,this.$remind("归还成功"),this.$search(this.table);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},mounted:function(){this.$search(this.table),this.getDocType(),this.getDocLocation()}},o=n,l=(a("de56"),a("2877")),c=Object(l["a"])(o,s,i,!1,null,"9e155ed0",null);c.options.__file="Index.vue";t["default"]=c.exports},acbe:function(e,t,a){},de56:function(e,t,a){"use strict";var s=a("acbe"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-2656a085.a2301bfe.js.map