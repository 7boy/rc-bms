(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23776570"],{"1f9a":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"publicity"},[i("bread-nav",{attrs:{nav:e.nav}}),i("main-part",[i("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"140px",rules:e.rules}},[i("el-form-item",{attrs:{label:"标题：",prop:"title"}},[i("el-input",{staticStyle:{width:"51%"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"正文内容：",prop:"content"}},[e.form.content||!e.id?i("wang-editor",{attrs:{content:e.form.content},on:{"update:content":function(t){e.$set(e.form,"content",t)}}}):e._e()],1),i("el-form-item",{attrs:{label:"选择截止时间：",prop:"endDate"}},[i("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"date","value-format":"yyyy-MM-dd 00:00:00",placeholder:"选择截止时间"},model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}})],1),i("el-form-item",{attrs:{label:"是否上传附件：",prop:"isAttachment"}},[i("el-radio-group",{model:{value:e.form.isAttachment,callback:function(t){e.$set(e.form,"isAttachment",t)},expression:"form.isAttachment"}},e._l(e.$enums.YesNoStatus.list,function(t,n){return i("el-radio",{key:n,staticStyle:{width:"106px","margin-right":"37px"},attrs:{border:"",label:t.value}},[e._v(e._s(t.label)+"\n          ")])}))],1),i("el-form-item",{attrs:{label:"推送范围：",prop:"scopeList"}},[i("el-input",{staticClass:"input",staticStyle:{width:"440px"},attrs:{placeholder:"请选择范围",disabled:""},model:{value:e.selectedDepName.join(),callback:function(t){e.$set(e.selectedDepName,"join()",t)},expression:"selectedDepName.join()"}},[i("el-button",{staticClass:"hende",attrs:{slot:"append"},on:{click:e.showDepDialog},slot:"append"},[e._v("选择范围")])],1)],1)],1),i("el-dialog",{staticClass:"dep-dialog",attrs:{visible:e.depDialog,width:"400px"},on:{"update:visible":function(t){e.depDialog=t}}},[i("div",{staticClass:"dep-form"},[i("p",{staticClass:"title"},[e._v(e._s(e.depTitle))]),i("div",{staticClass:"content"},[i("el-tree",{attrs:{data:e.depData,props:e.props,"show-checkbox":"","node-key":"orgId","default-checked-keys":e.selectedDep},on:{"check-change":e.handleCheckChange}})],1),i("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[i("div",{staticClass:"btn-submit",on:{click:function(t){e.depDialog=!1}}},[e._v("关闭")])])])]),i("div",{staticClass:"btns"},[i("div",{staticClass:"btn-submit",on:{click:function(t){e.doSubmit()}}},[e._v("确定")]),i("div",{staticClass:"btn-clear",staticStyle:{"margin-left":"20px"},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")])])],1)],1)},s=[],a=(i("ac6a"),i("f3e2"),i("57e7"),i("96cf"),i("1da1")),r=(i("a481"),i("5967")),c={components:{item:r["a"]},data:function(){var e=this,t=function(e,t,i){t&&"<p><br></p>"!==t?i():i(new Error("请输入正文内容"))},i=function(t,i,n){0===e.selectedDepName.length?n(new Error("请选择推送范围")):n()},n=this;return{id:n.$route.query.id,announcementDetail:[],nav:[{name:"拓展活动",path:"go(-1)"},{name:"发布活动",path:""}],text:"发布成功",depDialog:!1,depTitle:"家长组",depData:[],selectedDep:[],selectedDepName:[],form:{title:null,content:null,scopeList:[],isAttachment:null,endDate:null},attrs:{accept:"*"},rules:{title:{required:!0,message:"请输入标题",trigger:"blur"},content:{required:!0,validator:t,trigger:"change"},scopeList:{required:!0,validator:i,trigger:"change"},isAttachment:{required:!0,message:"请选择是否上传附件",trigger:"change"},endDate:{required:!0,message:"请选择截止时间",trigger:"change"}},uploadOptions:{target:"".concat(window.location.origin).concat(this.$conf.API_PATH,"/uploadFileTrunk/trunkUpload.do"),testChunks:!1,chunkSize:2097152,singleFile:!1,parseTimeRemaining:function(e,t){return t.replace(/\syears?/,"年").replace(/\days?/,"天").replace(/\shours?/,"小时").replace(/\sminutes?/,"分钟").replace(/\sseconds?/,"秒")}},fileStatusText:{success:"上传成功",error:"上传错误",uploading:"正在上传",paused:"已暂停",waiting:"等待中"},props:{label:"orgName",children:"subOrgList"}}},mounted:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/org/queryOrganizationTree.do",el:".content",query:{orgTypes:["PARENT_ORG"]}});case 2:t=e.sent,this.depData=this.recursion(t.subOrgList,1),this.id&&this.getDetail();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{handleCheckChange:function(e,t,i){var n=this.selectedDep.indexOf(e.orgId);t?(this.selectedDep.push(e.orgId),this.selectedDepName.push(e.orgName)):(this.selectedDep.splice(n,1),this.selectedDepName.splice(n,1))},recursion:function(e,t){var i=this;return e.forEach(function(e){e.tier=t,e.status=!1,e.subOrgList.length>0&&i.recursion(e.subOrgList,t+1)}),e},getDetail:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/notice/getNotice.do",el:".form",query:{id:this.id}});case 2:this.announcementDetail=e.sent,this.form.title=this.announcementDetail.title,this.form.content=this.announcementDetail.content,this.announcementDetail.scopeList.forEach(function(e){t.selectedDep.push(e.businessId),t.selectedDepName.push(e.scopeName)}),this.form.endDate=this.announcementDetail.endDate,this.form.isAttachment=this.announcementDetail.isAttachment,console.log(this.selectedDep);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showDepDialog:function(){this.depDialog=!0},doSubmit:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.form.validate();case 2:return this.form.scopeList=this.selectedDep,t="/notice/addActivity.do",this.id&&(this.text="修改成功",t="/notice/updateActivity.do",this.form.id=this.id),e.next=7,this.$ajax({url:t,el:".form",query:this.form});case 7:this.$remind(this.text),this.$router.push("/student-work/activity");case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},o=c,l=(i("7e14"),i("2877")),u=Object(l["a"])(o,n,s,!1,null,"74f22d7c",null);u.options.__file="Publicity.vue";t["default"]=u.exports},"243d":function(e,t,i){"use strict";var n=i("9a3c"),s=i.n(n);s.a},5967:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"form-item"},e._l(e.treeData,function(t){return i("div",[i("div",{class:["item",{hand:t.subOrgList.length||1===t.parentOrgId}],style:{paddingLeft:25*(t.tier-1)+10+"px"},on:{click:function(e){t.status=!t.status}}},[i("i",{class:[{rotate:t.status},"el-icon-caret-right"],style:{visibility:t.subOrgList.length?"visible":"hidden"}}),i("el-checkbox",{attrs:{value:e.judge(t.orgId)},on:{change:function(i){e.changeDep(t)}}},[i("span",[e._v(e._s(t.orgName))])])],1),i("el-collapse-transition",[i("item",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"item.status"}],attrs:{selectedDepName:e.selectedDepName,selectedDep:e.selectedDep,data:t.subOrgList}})],1)],1)}))},s=[],a=(i("57e7"),i("5488")),r=i.n(a),c={components:{elCollapseTransition:r.a},props:["data","selectedDep","selectedDepName"],name:"item",data:function(){return{}},computed:{treeData:function(){return this.data},treeSelectedDep:function(){return this.selectedDep},treeSelectedDepName:function(){return this.selectedDepName||[]}},methods:{changeDep:function(e){var t=this.treeSelectedDep.indexOf(e.orgId);-1===t?(this.treeSelectedDep.push(e.orgId),this.treeSelectedDepName.push(e.orgName)):(this.treeSelectedDep.splice(t,1),this.treeSelectedDepName.splice(t,1)),this.$emit("update:selectedDep",this.treeSelectedDep),this.$emit("update:selectedDepName",this.treeSelectedDepName)},judge:function(e){return-1!==this.treeSelectedDep.indexOf(e)}},mounted:function(){}},o=c,l=(i("243d"),i("2877")),u=Object(l["a"])(o,n,s,!1,null,"97780030",null);u.options.__file="Item.vue";t["a"]=u.exports},"7e14":function(e,t,i){"use strict";var n=i("9bcc"),s=i.n(n);s.a},"9a3c":function(e,t,i){},"9bcc":function(e,t,i){}}]);
//# sourceMappingURL=chunk-23776570.041b36a6.js.map