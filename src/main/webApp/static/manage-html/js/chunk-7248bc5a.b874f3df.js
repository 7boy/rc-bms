(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7248bc5a"],{"2dc8":function(t,e,n){},b2b6:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"detail"},[n("bread-nav",{attrs:{nav:t.nav}}),n("main-part",[n("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"机构名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入机构名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"法人",prop:"corporation"}},[n("el-input",{attrs:{placeholder:"请输入法人"},model:{value:t.form.corporation,callback:function(e){t.$set(t.form,"corporation",e)},expression:"form.corporation"}})],1),n("el-form-item",{attrs:{label:"联系人",prop:"linkMan"}},[n("el-input",{attrs:{placeholder:"请输入联系人"},model:{value:t.form.linkMan,callback:function(e){t.$set(t.form,"linkMan",e)},expression:"form.linkMan"}})],1),n("el-form-item",{attrs:{label:"联系电话",prop:"linkNum"}},[n("el-input",{attrs:{type:"tel",placeholder:"请输入联系电话"},model:{value:t.form.linkNum,callback:function(e){t.$set(t.form,"linkNum",e)},expression:"form.linkNum"}})],1),n("el-form-item",{attrs:{label:"机构区划",prop:"region"}},[n("el-cascader",{staticClass:"input",attrs:{options:t.options},on:{"active-item-change":t.handleItemChange},model:{value:t.region,callback:function(e){t.region=e},expression:"region"}})],1),n("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[n("el-input",{staticClass:"address",attrs:{id:"pickerInput",placeholder:"请输入详细地址"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1),n("div",{staticClass:"map",attrs:{id:"container",tabindex:"0"}}),n("div",{staticClass:"btns"},[n("div",{staticClass:"btn-submit btn-add mr15",on:{click:t.addFun}},[t._v("确认")]),n("div",{staticClass:"btn-clear",on:{click:function(e){t.$router.go(-1)}}},[t._v("取消")])])],1)],1)},i=[],a=(n("6d67"),n("7f7f"),n("ac6a"),n("f3e2"),n("96cf"),n("1da1")),o={data:function(){var t=this,e=function(e,n,r){t.region.length<1?r(new Error("请选择机构区划")):r()};return{editStatus:"0"!==this.$route.params.id,nav:[{name:"合作机构",path:"go(-1)"},{name:"0"!==this.$route.params.id?"编辑机构":"添加机构",path:""}],region:[],form:{name:"",corporation:"",linkMan:"",linkNum:"",address:"",provinceId:"",cityId:"",districtId:"",lng:"",lat:""},rules:{name:{required:!0,message:"请输入机构名称",trigger:"blur"},address:{required:!0,message:"请输入详细地址",trigger:"blur"},region:{required:!0,validator:e,trigger:"change"}},options:[]}},methods:{addFun:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$refs.form.validate();case 2:if(this.form.lng){t.next=5;break}return this.$message.warning("请在地图上选择机构位置"),t.abrupt("return");case 5:return this.region.length>0&&(e=this.region,this.form.provinceId=e[0],this.form.cityId=e[1],this.form.districtId=e[2]),n="/rinstitution/addTrainInstitution.do",r="新增成功",this.editStatus&&(n="/rinstitution/updateTrainInstitution.do",r="编辑成功",this.form.trainInstitutionId=this.form.id),t.next=11,this.$ajax({url:n,el:".btn-add",noText:!0,query:this.form});case 11:this.$remind(r),this.$router.push("/recruit/organization");case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getRegion:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/region/queryRegionList.do"});case 2:e=t.sent,this.options=[],e.forEach(function(t){n.options.push({label:t.name,value:t.id,children:[]})});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleItemChange:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e){var n,r,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/region/queryRegionList.do",query:{parentId:e[e.length-1]}});case 2:n=t.sent,r=[],1===e.length?(n.forEach(function(t){r.push({label:t.name,value:t.id,children:[]})}),this.options.forEach(function(t,n){t.value===e[0]&&(i.options[n].children=r)})):2===e.length&&(n.forEach(function(t){r.push({label:t.name,value:t.id})}),this.options.forEach(function(t,n){t.value===e[0]&&i.options[n].children.forEach(function(t,a){t.value===e[1]&&(i.options[n].children[a].children=r)})}));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),initMap:function(){this.map=new AMap.Map("container",{center:this.center,resizeEnable:!0,zoom:15});var t=this;function e(e){e.on("poiPicked",function(e){var n=e.item;t.form.address=n.name,t.drawDot(n.location.lng,n.location.lat)})}AMapUI.loadUI(["misc/PoiPicker"],function(t){var n=new t({input:"pickerInput"});e(n)}),AMap.event.addListener(t.map,"click",function(e){t.drawDot(e.lnglat.lng,e.lnglat.lat)})},drawDot:function(t,e){this.form.lng=t,this.form.lat=e,this.marker&&this.marker.setMap(null),this.marker=new AMap.Marker({position:[t,e],title:"位置",map:this.map}),this.map.setCenter([t,e])},getDetail:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/rinstitution/getTrainInstitution.do",el:".detail",query:{id:this.$route.params.id}});case 2:return this.form=t.sent,this.region=[],t.next=6,this.getRegion();case 6:return t.next=8,this.handleItemChange([this.form.provinceId]);case 8:return t.next=10,this.handleItemChange([this.form.provinceId,this.form.cityId]);case 10:this.drawDot(this.form.lng,this.form.lat),this.region=[this.form.provinceId,this.form.cityId,this.form.districtId];case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},mounted:function(){this.editStatus&&this.getDetail(),this.getRegion(),this.initMap()}},s=o,l=(n("d655"),n("2877")),c=Object(l["a"])(s,r,i,!1,null,"00306688",null);c.options.__file="Detail.vue";e["default"]=c.exports},d655:function(t,e,n){"use strict";var r=n("2dc8"),i=n.n(r);i.a}}]);
//# sourceMappingURL=chunk-7248bc5a.b874f3df.js.map