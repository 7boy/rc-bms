(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9dd3e520"],{5470:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"exam-batch"},[r("bread-nav",{attrs:{nav:t.nav}}),r("main-part",[r("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"批次名称",prop:"title"}},[r("el-input",{staticClass:"input",attrs:{placeholder:"请输入批次名称"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"招生类别",prop:"secondRecruitTypeId"}},[r("el-radio-group",{model:{value:t.form.secondRecruitTypeId,callback:function(e){t.$set(t.form,"secondRecruitTypeId",e)},expression:"form.secondRecruitTypeId"}},[t._l(t.typeList,function(e,i){return i<4?r("el-radio",{key:i,attrs:{label:e.id,border:""},on:{change:function(r){t.parentId=e.parentId}}},[t._v(t._s(e.name))]):t._e()}),r("br"),t._l(t.typeList,function(e,i){return i>=4?r("el-radio",{key:i,staticClass:"mt15",attrs:{label:e.id,border:""},on:{change:function(r){t.parentId=e.parentId}}},[t._v(t._s(e.name))]):t._e()})],2)],1),r("div",{staticClass:"separated-text"},[t._v("笔试设置")]),r("el-form-item",{attrs:{label:"考试时间",prop:"examTime"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择考试时间"},model:{value:t.form.examTime,callback:function(e){t.$set(t.form,"examTime",e)},expression:"form.examTime"}})],1),r("el-form-item",{attrs:{label:"考点设置",prop:"examCentreList"}},[r("resize-table",[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th",{attrs:{width:"45%"}},[t._v("考点名称")]),r("th",{attrs:{width:"35%"}},[t._v("最多容纳考生数(人)")]),r("th",{attrs:{width:"20%"}},[t._v("操作")])])]),r("tbody",[t._l(t.form.examCentreList,function(e,i){return r("tr",[r("td",[t._v(t._s(t.getName(e.trainInstitutionId)))]),r("td",[t._v(t._s(e.capacity))]),r("td",[r("span",{staticClass:"oper",on:{click:function(e){t.removeTest(i)}}},[t._v("删除")])])])}),r("tr",{directives:[{name:"show",rawName:"v-show",value:t.testAddStatus,expression:"testAddStatus"}]},[r("td",[r("el-select",{attrs:{"default-first-option":"",filterable:"",placeholder:"请选择",size:"small"},model:{value:t.testAdd,callback:function(e){t.testAdd=e},expression:"testAdd"}},t._l(t.testList,function(e,i){return r("el-option",{key:i,attrs:{disabled:t.form.examCentreList.some(function(t){return e.id===t.trainInstitutionId}),value:e.id,label:e.name}})}))],1),r("td",[r("el-input-number",{attrs:{"controls-position":"right",size:"small",min:1,max:1e4},model:{value:t.testNum,callback:function(e){t.testNum=e},expression:"testNum"}})],1),r("td",[r("span",{staticClass:"oper mr10",on:{click:t.affirmAddTest}},[t._v("完成")]),r("span",{staticClass:"oper",on:{click:function(e){t.testAddStatus=!1}}},[t._v("删除")])])]),r("i",{staticClass:"icon el-icon-circle-plus",on:{click:function(e){t.addTestFun()}}})],2)])])],1),r("div",{staticClass:"separated-text"},[t._v("面试设置")]),r("el-form-item",{attrs:{label:"面试时间"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择考试时间"},model:{value:t.form.interviewTime,callback:function(e){t.$set(t.form,"interviewTime",e)},expression:"form.interviewTime"}})],1),r("el-form-item",{attrs:{label:"面试地点"}},[r("el-radio-group",{model:{value:t.form.campusId,callback:function(e){t.$set(t.form,"campusId",e)},expression:"form.campusId"}},t._l(t.campus,function(e,i){return r("el-radio",{key:i,attrs:{label:e.id,border:""}},[t._v(t._s(e.name))])}))],1)],1),r("div",{staticClass:"btns"},[r("div",{staticClass:"btn-submit mr15",on:{click:t.doSubmit}},[t._v("确认")]),r("div",{staticClass:"btn-clear",on:{click:function(e){t.$router.go(-1)}}},[t._v("取消")])])],1)],1)},s=[],a=(r("ac6a"),r("f3e2"),r("7f7f"),r("759f"),r("96cf"),r("1da1")),n={data:function(){var t=this,e=function(e,r,i){t.isCulture||i(),r?i():i(new Error("请选择考试时间"))},r=function(e,r,i){t.isCulture||t.editStatus||i(),t.form.examCentreList.length?i():i(new Error("至少需要选择一个考点"))},i=function(e,r,i){t.specialtyType.length?i():i(new Error("请选择特长类别"))},s=function(e,r,i){t.form.firstRecruitTypeId||t.form.secondRecruitTypeId?i():i(new Error("请选择招生类别"))};return{editStatus:"0"!==this.$route.params.id,isCulture:"CULTURE"===this.$route.query.recruitType,nav:[{name:"考试管理",path:"go(-1)"},{name:"0"!==this.$route.params.id?"编辑招生批次":"新增招生批次",path:""}],form:{recruitType:this.$route.query.recruitType,secondRecruitTypeId:"",title:"",examTime:"",examCentreList:[],interviewTime:""},rules:{title:{required:!0,message:"请输入批次名称",trigger:"blur"},secondRecruitTypeId:{required:!0,validator:s,trigger:"change"},examTime:{required:"CULTURE"===this.$route.query.recruitType,validator:e,trigger:"change"},specialtyType:{required:!0,validator:i,trigger:"change"},examCentreList:{required:"CULTURE"===this.$route.query.recruitType||"0"!==this.$route.params.id,validator:r,trigger:"blur"}},testList:[],testAdd:"",testNum:1,testAddStatus:!1,typeList:[],parentId:null,specialtyList:[],specialtyType:[],campus:[]}},methods:{getList:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/rinstitution/queryTrainInstitutionList.do"});case 2:this.testList=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),addTestFun:function(){this.testAddStatus||(this.testAdd="",this.testNum=1,this.testAddStatus=!0)},removeTest:function(t){this.form.examCentreList.splice(t,1),0===this.form.examCentreList.length&&this.$refs.form.validateField("examCentreList")},affirmAddTest:function(){this.form.examCentreList.push({trainInstitutionId:this.testAdd,capacity:this.testNum}),this.$refs.form.clearValidate(["examCentreList"]),this.testAddStatus=!1},getName:function(t){var e="";return this.testList.some(function(r){if(r.id===t)return e=r.name,!0}),e},getType:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.typeList=[],this.type=[],t.next=4,this.$ajax({url:"/dict/queryDictList.do",query:{dictType:this.isCulture?"RECRUIT_CULTURE":"RECRUIT_SPECIALITY"}});case 4:if(e=t.sent,this.isCulture){t.next=8;break}return this.typeList=e,t.abrupt("return");case 8:e.forEach(function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.$ajax({url:"/dict/queryDictList.do",query:{parentId:e.id,dictType:e.dictType}});case 2:i=t.sent,r.typeList.length?r.typeList=i.concat(r.typeList):r.typeList=r.typeList.concat(i);case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}());case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getSpecialty:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/dict/queryDictList.do",query:{dictType:"SPECIALITY"}});case 2:e=t.sent,this.specialtyList=[],e.forEach(function(t){r.specialtyList.push({label:t.name,value:t.id,children:[]})});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleItemChange:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e){var r,i,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/dict/queryDictList.do",query:{parentId:e[0],dictType:"SPECIALITY"}});case 2:r=t.sent,i=[],r.forEach(function(t){i.push({label:t.name,value:t.id})}),this.specialtyList.forEach(function(t,r){t.value===e[0]&&(s.specialtyList[r].children=i)});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),doSubmit:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var e,r,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$refs.form.validate();case 2:return e=this.form,e.examTime&&(e.examTime=new Date(e.examTime).$Format("yyyy-MM-dd hh:mm:ss")),e.interviewTime&&(e.interviewTime=new Date(e.interviewTime).$Format("yyyy-MM-dd hh:mm:ss")),this.isCulture?e.firstRecruitTypeId=this.parentId:(e.firstRecruitTypeId=this.form.secondRecruitTypeId,e.secondRecruitTypeId=null),r="/rbatch/addBatch.do",i="新增成功",this.editStatus&&(r="/rbatch/updateBatch.do",i="更新成功",this.form.batchId=this.form.id),t.next=11,this.$ajax({url:r,el:".btn-submit",noText:!0,query:this.form});case 11:this.$remind(i),this.$router.push("/recruit/exam?recruitType=".concat(this.$route.query.recruitType));case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getCampusList:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/campus/queryCampusList.do"});case 2:this.campus=t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getDetail:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$ajax({url:"/rbatch/getBatch.do",query:{id:this.$route.params.id}});case 2:this.form=t.sent,this.isCulture?this.parentId=this.form.firstRecruitTypeId:(this.form.secondRecruitTypeId=this.form.firstRecruitTypeId,this.form.firstRecruitTypeId=null);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},mounted:function(){this.isCulture||this.getSpecialty(),this.getCampusList(),this.getType(),this.getList(),this.editStatus&&this.getDetail()}},u=n,c=(r("f9c9"),r("2877")),o=Object(c["a"])(u,i,s,!1,null,"18234b94",null);o.options.__file="Batch.vue";e["default"]=o.exports},"759f":function(t,e,r){"use strict";var i=r("5ca1"),s=r("0a49")(3);i(i.P+i.F*!r("2f21")([].some,!0),"Array",{some:function(t){return s(this,t,arguments[1])}})},"7d8a":function(t,e,r){},f9c9:function(t,e,r){"use strict";var i=r("7d8a"),s=r.n(i);s.a}}]);
//# sourceMappingURL=chunk-9dd3e520.151cc01b.js.map