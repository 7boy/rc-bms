(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cb0209b"],{"18c9":function(e,t,s){},"243d":function(e,t,s){"use strict";var r=s("9a3c"),a=s.n(r);a.a},5967:function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-item"},e._l(e.treeData,function(t){return s("div",[s("div",{class:["item",{hand:t.subOrgList.length||1===t.parentOrgId}],style:{paddingLeft:25*(t.tier-1)+10+"px"},on:{click:function(e){t.status=!t.status}}},[s("i",{class:[{rotate:t.status},"el-icon-caret-right"],style:{visibility:t.subOrgList.length?"visible":"hidden"}}),s("el-checkbox",{attrs:{value:e.judge(t.orgId)},on:{change:function(s){e.changeDep(t)}}},[s("span",[e._v(e._s(t.orgName))])])],1),s("el-collapse-transition",[s("item",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"item.status"}],attrs:{selectedDepName:e.selectedDepName,selectedDep:e.selectedDep,data:t.subOrgList}})],1)],1)}))},a=[],i=(s("57e7"),s("5488")),n=s.n(i),l={components:{elCollapseTransition:n.a},props:["data","selectedDep","selectedDepName"],name:"item",data:function(){return{}},computed:{treeData:function(){return this.data},treeSelectedDep:function(){return this.selectedDep},treeSelectedDepName:function(){return this.selectedDepName||[]}},methods:{changeDep:function(e){var t=this.treeSelectedDep.indexOf(e.orgId);-1===t?(this.treeSelectedDep.push(e.orgId),this.treeSelectedDepName.push(e.orgName)):(this.treeSelectedDep.splice(t,1),this.treeSelectedDepName.splice(t,1)),this.$emit("update:selectedDep",this.treeSelectedDep),this.$emit("update:selectedDepName",this.treeSelectedDepName)},judge:function(e){return-1!==this.treeSelectedDep.indexOf(e)}},mounted:function(){}},o=l,c=(s("243d"),s("2877")),u=Object(c["a"])(o,r,a,!1,null,"97780030",null);u.options.__file="Item.vue";t["a"]=u.exports},"9a3c":function(e,t,s){},"9d62":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"detail"},[s("bread-nav",{attrs:{nav:e.nav}}),s("main-part",[s("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules,"label-width":"80px"}},[s("el-form-item",{staticClass:"item",attrs:{label:"姓名",prop:"name"}},[s("el-input",{staticClass:"input",attrs:{placeholder:"请输入姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[s("el-select",{staticClass:"sex-select",attrs:{slot:"append",placeholder:"性别"},slot:"append",model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},e._l(e.$enums.Sex.list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),s("el-form-item",{staticClass:"item",attrs:{label:"是否教师",prop:"isTeacher"}},[s("el-radio-group",{model:{value:e.form.isTeacher,callback:function(t){e.$set(e.form,"isTeacher",t)},expression:"form.isTeacher"}},e._l(e.$enums.YesNoStatus.list,function(t,r){return s("el-radio",{key:r,attrs:{label:t.value,border:""}},[e._v("  "+e._s(t.label)+"  ")])}))],1),s("el-form-item",{staticClass:"item",attrs:{label:"手机号",prop:"phone"}},[s("el-input",{staticClass:"input phone",attrs:{maxLength:"11",type:"number",placeholder:"请输入手机号"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),s("el-form-item",{staticClass:"item",attrs:{label:"所属部门",prop:"orgIds"}},[s("el-input",{staticClass:"input dep",attrs:{disabled:"",placeholder:"请选择所属部门"},model:{value:e.selectedDepName.join(),callback:function(t){e.$set(e.selectedDepName,"join()",t)},expression:"selectedDepName.join()"}},[s("el-button",{staticClass:"hand",attrs:{slot:"append"},on:{click:function(t){e.depDialog=!0}},slot:"append"},[e._v("选择部门")])],1)],1),s("el-form-item",{staticClass:"item",attrs:{label:"职务"}},[s("el-input",{staticClass:"input",attrs:{placeholder:"请输入职务"},model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1),s("el-form-item",{staticClass:"item",attrs:{label:"角色",prop:"roleIds"}},[s("el-select",{staticClass:"input",model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},e._l(e.roleList,function(e,t){return s("el-option",{key:t,attrs:{disabled:1===e.id,label:e.name,value:e.id}})}))],1)],1),s("div",{staticClass:"btns"},[s("div",{staticClass:"btn-submit btn-add mr20",on:{click:e.doSubmit}},[e._v(e._s(e.editStatus?"更新":"新增"))]),s("div",{staticClass:"btn-clear",on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")])]),s("el-dialog",{staticClass:"dialog",attrs:{visible:e.depDialog,width:"400px"},on:{"update:visible":function(t){e.depDialog=t}}},[s("div",{staticClass:"dep-form"},[s("p",{staticClass:"title"},[e._v(e._s(e.depTitle))]),s("div",{staticClass:"content"},[s("item",{attrs:{data:e.depData,selectedDep:e.selectedDep,selectedDepName:e.selectedDepName},on:{"update:selectedDep":function(t){e.selectedDep=t},"update:selectedDepName":function(t){e.selectedDepName=t}}})],1),s("div",{staticClass:"btns"},[s("div",{staticClass:"btn-submit",on:{click:function(t){e.depDialog=!1}}},[e._v("关闭")])])])])],1)],1)},a=[],i=(s("7f7f"),s("ac6a"),s("f3e2"),s("96cf"),s("1da1")),n=(s("cadf"),s("551c"),s("097d"),s("5967")),l={components:{item:n["a"]},data:function(){var e=this,t=function(t,s,r){if(!e.selectedDep.length)return r(new Error("请选择所属部门"));r()},s=function(t,s,r){if(!e.roleIds)return r(new Error("请选择用户角色"));r()};return{editStatus:"0"!==this.$route.params.id,nav:[{name:"用户管理",path:"go(-1)"},{name:this.editStatus?"编辑用户":"新增用户",path:""}],form:{name:"",sex:"Male",phone:"",isTeacher:"",position:"",orgIds:"",roleIds:[]},roleIds:"",rules:{name:{required:!0,message:"请输入姓名",trigger:"blur"},sex:{required:!0,message:"请选择性别",trigger:"change"},phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:11,max:11,message:"手机号格式错误",trigger:"blur"}],isTeacher:{required:!0,message:"请选择是否为教师",trigger:"change"},orgIds:{required:!0,validator:t,trigger:"change"},roleIds:{required:!0,validator:s,trigger:"change"}},depTitle:"",depData:[],selectedDep:[],selectedDepName:[],roleList:[],depDialog:!1}},methods:{getDetail:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/user/getUserDetail.do",query:{userId:this.$route.params.id}});case 2:t=e.sent,this.selectedDep=[],t.orgList.forEach(function(e){s.selectedDep.push(e.id),s.selectedDepName.push(e.name)}),this.form=t,this.roleIds=t.roleList[0].id;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),doSubmit:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t="用户新增成功",s="/user/addUser.do",this.editStatus&&(t="用户更新成功",s="/user/updateUser.do"),e.next=5,this.$refs.form.validate();case 5:return this.form.orgIds=this.selectedDep,this.form.roleIds=[this.roleIds],e.next=9,this.$ajax({url:s,el:".btn-add",noText:!0,query:this.form});case 9:this.$remind(t),this.$router.push("/school/user");case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),updateFun:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.form.validate();case 2:return this.form.orgIds=this.selectedDep,e.next=5,this.$ajax({url:"/user/updateUser.do",el:".btn-add",query:this.form});case 5:this.$remind("用户更新成功"),this.$router.push("/school/user");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getAllDep:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/org/queryOrganizationTree.do",query:{orgTypes:["ADMIN_ORG","TEACH_ORG"]}});case 2:t=e.sent,this.depTitle=t.orgName,this.depData=this.recursion(t.subOrgList,1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),recursion:function(e,t){var s=this;return e.forEach(function(e){e.tier=t,e.status=!1,e.subOrgList.length>0&&s.recursion(e.subOrgList,t+1)}),e},getAllRole:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/role/queryRoleList.do"});case 2:this.roleList=e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},mounted:function(){this.getAllDep(),this.getAllRole(),this.editStatus&&this.getDetail()}},o=l,c=(s("fa98"),s("2877")),u=Object(c["a"])(o,r,a,!1,null,"62c70032",null);u.options.__file="Detail.vue";t["default"]=u.exports},fa98:function(e,t,s){"use strict";var r=s("18c9"),a=s.n(r);a.a}}]);
//# sourceMappingURL=chunk-6cb0209b.5bf43880.js.map