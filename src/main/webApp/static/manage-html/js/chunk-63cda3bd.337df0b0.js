(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63cda3bd"],{"087a":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user"},[n("bread-nav",{attrs:{nav:e.nav}}),n("main-part",[n("div",{staticClass:"btn-block mb20"},[n("a",{staticClass:"f-small main-c",attrs:{download:"",href:"../gy-files/template/用户导入模板.xlsx"}},[e._v("下载模板")]),n("label",{attrs:{for:"importDom"}},[n("div",{staticClass:"btn-main btn-upload mr15 ml5"},[e._v("批量导入")])]),n("input",{ref:"upload",attrs:{accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"importDom",type:"file",hidden:""},on:{change:function(t){e.upload(t)}}}),n("div",{staticClass:"btn-main mr15",on:{click:function(t){e.$exportDetail("/export/exportUserData.do",{})}}},[e._v("批量导出")]),n("div",{staticClass:"btn-main mr15",on:{click:function(t){e.removeBatch()}}},[e._v("批量删除")]),n("div",{staticClass:"btn-main-deepen mr15",on:{click:e.showDialog}},[e._v("所属部门")]),n("div",{staticClass:"btn-main-deepen",on:{click:function(t){e.$router.push("/school/user/0")}}},[e._v("添加用户")])]),n("div",{staticClass:"oz-box"},[n("el-input",{attrs:{placeholder:"姓名/手机号"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.$search(e.table)}},model:{value:e.table.query.keywords,callback:function(t){e.$set(e.table.query,"keywords",t)},expression:"table.query.keywords"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.$search(e.table)}},slot:"append"})],1),n("index-item",{attrs:{selectedDep:e.selectedDep,data:e.depData},on:{changeOrz:e.changeOrz,"update:selectedDep":function(t){e.selectedDep=t}}})],1),n("div",{staticClass:"table-box"},[n("resize-table",[n("table",{staticClass:"table"},[n("thead",[n("tr",[n("th",{attrs:{width:"4%"}},[n("el-checkbox",{model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}})],1),n("th",{attrs:{width:"8%"}},[e._v("姓名")]),n("th",{attrs:{width:"11%"}},[e._v("职务")]),n("th",{attrs:{width:"20%"}},[e._v("所属部门")]),n("th",{attrs:{width:"14%"}},[e._v("角色")]),n("th",{attrs:{width:"12%"}},[e._v("手机号")]),n("th",{attrs:{width:"6%"}},[e._v("状态")]),n("th",{attrs:{width:"15%"}},[e._v("操作")])])]),n("tbody",e._l(e.table.list,function(t,s){return n("tr",[n("td",[n("el-checkbox",{model:{value:e.checkboxList[s],callback:function(t){e.$set(e.checkboxList,s,t)},expression:"checkboxList[key]"}})],1),n("td",[e._v(e._s(t.name))]),n("td",[e._v(e._s(t.position))]),n("td",[n("el-tooltip",{attrs:{content:t.orgList?t.orgList.map(function(e){return e.name}).join():"--",placement:"top",effect:"dark"}},[n("p",{staticClass:"org-list"},[e._v(e._s(t.orgList?t.orgList.map(function(e){return e.name}).join():"--"))])])],1),n("td",[n("el-tooltip",{attrs:{content:t.roleList?t.roleList.map(function(e){return e.name}).join():"--",placement:"top",effect:"dark"}},[n("p",{staticClass:"org-list"},[e._v(e._s(t.roleList?t.roleList.map(function(e){return e.name}).join():"--"))])])],1),n("td",[e._v(e._s(t.phone))]),n("td",[e._v(e._s("Enabled"===t.enableStatus?"启用":"禁用"))]),n("td",[1!==t.userId?n("div",[n("span",{staticClass:"oper",on:{click:function(n){e.$router.push("/school/user/"+t.userId)}}},[e._v("编辑")]),n("span",{staticClass:"oper",on:{click:function(n){e.remove(t)}}},[e._v("删除")]),n("span",{directives:[{name:"show",rawName:"v-show",value:"Enabled"===t.enableStatus,expression:"item.enableStatus === 'Enabled'"}],staticClass:"oper",on:{click:function(n){e.disableUser(t)}}},[e._v("禁用")]),n("span",{directives:[{name:"show",rawName:"v-show",value:"Unenabled"===t.enableStatus,expression:"item.enableStatus === 'Unenabled'"}],staticClass:"oper",on:{click:function(n){e.openUser(t)}}},[e._v("启用")])]):e._e()])])}))])]),n("no-data",{directives:[{name:"show",rawName:"v-show",value:!e.table.noData,expression:"!table.noData"}]}),n("paging",{attrs:{data:e.table},on:{"update:data":function(t){e.table=t}}})],1),n("el-dialog",{staticClass:"dialog",attrs:{visible:e.setDepDialog,width:"400px"},on:{"update:visible":function(t){e.setDepDialog=t}}},[e.setDepDialog?n("div",{staticClass:"dep-form"},[n("p",{staticClass:"title"},[e._v(e._s(e.depTitle))]),n("div",{staticClass:"content"},[n("item",{attrs:{data:e.setDepData,selectedDep:e.setDepId},on:{"update:selectedDep":function(t){e.setDepId=t}}})],1),n("div",{staticClass:"btns"},[n("div",{staticClass:"btn-submit btn-set mr15",on:{click:function(t){e.setDepDialog=!1}}},[e._v("关闭")])])]):e._e()])],1)],1)},a=[],r=(n("7f7f"),n("759f"),n("ac6a"),n("f3e2"),n("96cf"),n("1da1")),i=(n("2caf"),n("6c7b"),n("cadf"),n("551c"),n("097d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-item"},e._l(e.treeData,function(t){return n("div",[n("div",{class:["item",{hand:t.subOrgList.length||1===t.parentOrgId}],style:{paddingLeft:25*(t.tier-1)+10+"px"},on:{click:function(e){t.status=!t.status}}},[n("i",{class:[{rotate:t.status},"el-icon-caret-right"],style:{visibility:t.subOrgList.length?"visible":"hidden"}}),n("el-checkbox",{attrs:{value:e.judge(t.orgId)},on:{change:function(n){e.changeDep(t)}}},[n("span",[e._v(e._s(t.orgName))])])],1),n("el-collapse-transition",[n("item",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"item.status"}],attrs:{selectedDep:e.selectedDep,data:t.subOrgList},on:{changeOrz:function(t){e.$emit("changeOrz",e.treeSelectedDep)}}})],1)],1)}))}),c=[],o=(n("57e7"),n("5488")),l=n.n(o),u={components:{elCollapseTransition:l.a},props:["data","selectedDep"],name:"item",data:function(){return{}},computed:{treeData:function(){return this.data},treeSelectedDep:function(){return this.selectedDep}},methods:{changeDep:function(e){this.treeSelectedDep[0]===e.orgId?this.treeSelectedDep.splice(0,1):(this.treeSelectedDep.splice(0,1),this.treeSelectedDep.push(e.orgId)),this.$emit("changeOrz",this.treeSelectedDep)},judge:function(e){return-1!==this.treeSelectedDep.indexOf(e)}},mounted:function(){}},d=u,h=(n("df1e"),n("2877")),p=Object(h["a"])(d,i,c,!1,null,"f34fdd32",null);p.options.__file="IndexItem.vue";var f=p.exports,m=n("5967"),v=n("c8e7"),b={mixins:[v["a"].$exportDetail],components:{indexItem:f,item:m["a"]},data:function(){return{nav:[{name:"用户管理",path:""}],searchData:[{type:"input",placeholder:"用户名"}],table:{url:"/user/queryUserPage.do",el:".table",total:0,noData:!0,list:[],query:{orgId:null,keywords:""}},selectedDep:[],checkboxList:[!1],depData:[],setDepData:[],depTitle:"",setDepId:[],setDepName:[],setDepDialog:!1}},watch:{"table.list":function(){this.checkboxList=new Array(this.table.list.length).fill(!1)}},computed:{checkAll:{get:function(){return this.checkboxList.length>0&&this.checkboxList.every(function(e){return e})},set:function(e){this.checkboxList=new Array(this.table.list.length).fill(e)}}},methods:{showDialog:function(){this.checkboxList.every(function(e){return!e})?this.$message.warning("请选择用户"):this.setDepDialog=!0},upload:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n,s,a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.target.files.length){e.next=2;break}return e.abrupt("return");case 2:return n=t.target.files[0],this.$refs.upload.value=null,s=new FormData,s.append("file",n),a={url:"/import/importUser.do",query:s,el:".btn-upload",noText:!0},e.next=9,this.$ajax(a);case 9:r=e.sent,r.errMsgList&&r.errMsgList.length?this.$message.error(r.errMsgList[0]):this.$remind("导入成功"),this.$search(this.table);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setDepFun:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=[],this.checkboxList.forEach(function(e,s){e&&t.push(n.table.list[s].userId)}),e.next=4,this.$ajax({url:"/user/setOrgUsersBatch.do",el:"btn-set",noText:!0,query:{orgId:this.setDepId,userIds:t}});case 4:this.$remind("设置成功"),this.$search(this.table),this.setDepDialog=!1;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),changeOrz:function(e){this.table.query.orgId=e[0],this.$search(this.table)},getAllDep:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax({url:"/org/queryOrganizationTree.do",query:{orgTypes:["ADMIN_ORG","TEACH_ORG"]}});case 2:t=e.sent,this.depTitle=t.orgName,this.depData=this.recursion(t.subOrgList,1),this.setDepData=JSON.parse(JSON.stringify(this.depData));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),recursion:function(e,t){var n=this;return e.forEach(function(e){e.tier=t,e.status=!1,e.subOrgList.length>0&&n.recursion(e.subOrgList,t+1)}),e},removeBatch:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkboxList.some(function(e){return e}),t){e.next=4;break}return this.$message.warning("请先选择用户"),e.abrupt("return");case 4:return e.next=6,this.$confirm("您确认删除选中的用户吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 6:return n=[],this.checkboxList.forEach(function(e,t){e&&n.push(s.table.list[t].userId)}),e.next=10,this.$ajax({url:"/user/deleteUserBatch.do",query:{userIds:n}});case 10:this.$remind("禁用成功"),this.$search(this.table);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),disableUser:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("您确认禁用【".concat(t.name,"】吗"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 2:return e.next=4,this.$ajax({url:"/user/disableUser.do",query:{userId:t.userId}});case 4:this.$remind("禁用成功"),this.$search(this.table);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),openUser:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("您确认启用【".concat(t.name,"】吗"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 2:return e.next=4,this.$ajax({url:"/user/enableUser.do",query:{userId:t.userId}});case 4:this.$remind("启用成功"),this.$search(this.table);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("您确认删除【".concat(t.name,"】吗"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 2:return e.next=4,this.$ajax({url:"/user/deleteUser.do",query:{userId:t.userId}});case 4:this.$remind("删除成功"),this.$search(this.table);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},mounted:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$search(this.table);case 2:this.getAllDep(),this.checkboxList=new Array(this.table.list.length).fill(!1);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},g=b,D=(n("1344"),Object(h["a"])(g,s,a,!1,null,"6e665c66",null));D.options.__file="Index.vue";t["default"]=D.exports},"0a85":function(e,t,n){},1344:function(e,t,n){"use strict";var s=n("0a85"),a=n.n(s);a.a},"243d":function(e,t,n){"use strict";var s=n("9a3c"),a=n.n(s);a.a},"2caf":function(e,t,n){var s=n("5ca1");s(s.S,"Array",{isArray:n("1169")})},"36bd":function(e,t,n){"use strict";var s=n("4bf8"),a=n("77f1"),r=n("9def");e.exports=function(e){var t=s(this),n=r(t.length),i=arguments.length,c=a(i>1?arguments[1]:void 0,n),o=i>2?arguments[2]:void 0,l=void 0===o?n:a(o,n);while(l>c)t[c++]=e;return t}},"490b":function(e,t,n){},5967:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-item"},e._l(e.treeData,function(t){return n("div",[n("div",{class:["item",{hand:t.subOrgList.length||1===t.parentOrgId}],style:{paddingLeft:25*(t.tier-1)+10+"px"},on:{click:function(e){t.status=!t.status}}},[n("i",{class:[{rotate:t.status},"el-icon-caret-right"],style:{visibility:t.subOrgList.length?"visible":"hidden"}}),n("el-checkbox",{attrs:{value:e.judge(t.orgId)},on:{change:function(n){e.changeDep(t)}}},[n("span",[e._v(e._s(t.orgName))])])],1),n("el-collapse-transition",[n("item",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"item.status"}],attrs:{selectedDepName:e.selectedDepName,selectedDep:e.selectedDep,data:t.subOrgList}})],1)],1)}))},a=[],r=(n("57e7"),n("5488")),i=n.n(r),c={components:{elCollapseTransition:i.a},props:["data","selectedDep","selectedDepName"],name:"item",data:function(){return{}},computed:{treeData:function(){return this.data},treeSelectedDep:function(){return this.selectedDep},treeSelectedDepName:function(){return this.selectedDepName||[]}},methods:{changeDep:function(e){var t=this.treeSelectedDep.indexOf(e.orgId);-1===t?(this.treeSelectedDep.push(e.orgId),this.treeSelectedDepName.push(e.orgName)):(this.treeSelectedDep.splice(t,1),this.treeSelectedDepName.splice(t,1)),this.$emit("update:selectedDep",this.treeSelectedDep),this.$emit("update:selectedDepName",this.treeSelectedDepName)},judge:function(e){return-1!==this.treeSelectedDep.indexOf(e)}},mounted:function(){}},o=c,l=(n("243d"),n("2877")),u=Object(l["a"])(o,s,a,!1,null,"97780030",null);u.options.__file="Item.vue";t["a"]=u.exports},"6c7b":function(e,t,n){var s=n("5ca1");s(s.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},"759f":function(e,t,n){"use strict";var s=n("5ca1"),a=n("0a49")(3);s(s.P+s.F*!n("2f21")([].some,!0),"Array",{some:function(e){return a(this,e,arguments[1])}})},"9a3c":function(e,t,n){},c8e7:function(e,t,n){"use strict";n("a481");t["a"]={$exportDetail:{methods:{$exportDetail:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.table.query,n="?";for(var s in t)t[s]&&"pageNo"!==s&&"pageSize"!==s&&(n+="".concat(s,"=").concat(t[s],"&"));window.open(this.$conf.API_PATH+e+n.substr(0,n.length-1))}}},$spliceHTML:{methods:{$spliceHTML:function(e){return e=e.replace('<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8">',""),e=e.replace("</head>",""),e=e.replace("</body></html>",""),e=e.replace(/<h2>(.*)<\/h2>/,""),e}}}}},df1e:function(e,t,n){"use strict";var s=n("490b"),a=n.n(s);a.a}}]);
//# sourceMappingURL=chunk-63cda3bd.337df0b0.js.map